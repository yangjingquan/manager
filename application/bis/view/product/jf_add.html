<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<meta name="renderer" content="webkit|ie-comp|ie-stand">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta http-equiv="Cache-Control" content="no-siteapp" />
	<LINK rel="Bookmark" href="/favicon.ico" >
	<LINK rel="Shortcut Icon" href="/favicon.ico" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/admin/h_ui/static/h-ui/css/H-ui.min.css" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/admin/h_ui/static/h-ui.admin/css/H-ui.admin.css" />
	<style>
		.input-text1-15 {
			width: 15%;
		}

		.input-text1-8 {
			width: 8%;
		}

		label.intro {
			color: red;
		}


	</style>
	<script>
		function checkParams(){
			var p_name = document.getElementById('p_name');
			var producing_area = document.getElementById('producing_area');
			var original_price = document.getElementById('original_price');
			var associator_price = document.getElementById('associator_price');
			var ex_jifen = document.getElementById('ex_jifen');
			var weight = document.getElementById('weight');
			var huohao = document.getElementById('huohao');
			var content1_name =document.getElementsByName('content1_name[]');
			var con_content1 =document.getElementsByName('con_content1[]');
			var ex_jifen1 =document.getElementsByName('ex_jifen[]');
			var unit_price =document.getElementsByName('unit_price[]');
			//验证上传图片问题
			var thumb =document.getElementById('thumb').files;
			var image =document.getElementById('image').files;
			var config_image1 =document.getElementById('config_image1').files;
			var config_image2 =document.getElementById('config_image2').files;
			var config_image3 =document.getElementById('config_image3').files;
			var config_image4 =document.getElementById('config_image4').files;
			var wx_config_image1 =document.getElementById('wx_config_image1').files;
			var wx_config_image2 =document.getElementById('wx_config_image2').files;
			var wx_config_image3 =document.getElementById('wx_config_image3').files;
			var wx_config_image4 =document.getElementById('wx_config_image4').files;
			var wx_config_image5 =document.getElementById('wx_config_image5').files;
			var wx_config_image6 =document.getElementById('wx_config_image6').files;
			var wx_config_image7 =document.getElementById('wx_config_image7').files;
			var wx_config_image8 =document.getElementById('wx_config_image8').files;
			var wx_config_image9 =document.getElementById('wx_config_image9').files;
			var wx_config_image10 =document.getElementById('wx_config_image10').files;

			if(!p_name.value || p_name.value == ''){
				alert('请填写商品名称!');
				return false;
			}
			if(!producing_area.value || producing_area.value == ''){
				alert('请填写商品产地!');
				return false;
			}
			for( var i = 0; i < content1_name.length; i++) {
				if(!content1_name[i].value || !con_content1[i].value || !ex_jifen1[i].value || !unit_price[i].value){
					alert('请补全配置信息!');
					return false;
				}
				continue;
			}
			if(!original_price.value || original_price.value == ''){
				alert('请填写商品原价!');
				return false;
			}
			if(!associator_price.value || associator_price.value == ''){
				alert('请填写商品会员价!');
				return false;
			}

			if(!ex_jifen.value || ex_jifen.value == ''){
				alert('请填写兑换积分!');
				return false;
			}
			if(!weight.value || weight.value == '' || weight.value == 0){
				alert('请填写商品重量!');
				return false;
			}
			if(!huohao.value || huohao.value == ''){
				alert('请填写商品货号!');
				return false;
			}
			if(thumb.length < 1){
				alert('请上传商品缩略图!');
				return false;
			}
			if(image.length < 1 && config_image1.length < 1 && config_image2.length < 1 && config_image3.length < 1 && config_image4.length < 1){
				alert('请上传商品配置图片!');
				return false;
			}
			if(wx_config_image1.length < 1 && wx_config_image2.length < 1 && wx_config_image3.length < 1 && wx_config_image4.length < 1 && wx_config_image5.length < 1 && wx_config_image6.length < 1 && wx_config_image7.length < 1 && wx_config_image8.length < 1 && wx_config_image9.length < 1 && wx_config_image10.length < 1){
				alert('请上传商品介绍图片!');
				return false;
			}
			return true;

		}
	</script>
</head>
<body>
<div class="page-container">
	<form action="{:url('product/jf_save')}" method="post" enctype="multipart/form-data" class="form form-horizontal" id="form-article-add" onsubmit="return checkParams();">
		<input type="hidden" name="config_type" value="1">
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">平台分类：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<label>一级分类: </label>
				<span class="select-box" style="width: 15%;">
					<select name="cat1_id" class="select cat1">
						{volist name="first_category" id="vo"}
						<option value="{$vo.id}">{$vo.cat_name}</option>
						{/volist}
					</select>
				</span>
				<label style="margin-left: 1%;">二级分类: </label>
				<span class="select-box" style="width: 15%;">
					<select name="cat2_id" class="select cat2">
					</select>
				</span>
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">自定义分类：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<label>大类: </label>
				<span class="select-box" style="width: 15%;">
					<select name="d_cat1_id" class="select d_cat1">
					{volist name="defined_category" id="vo"}
						<option value="{$vo.id}">{$vo.cat_name}</option>
					{/volist}
					</select>
				</span>
				<label style="margin-left: 1%;">小类: </label>
				<span class="select-box" style="width: 15%;">
					<select name="d_cat2_id" class="select d_cat2">
					</select>
				</span>
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品名称：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1" value="" placeholder="" id="p_name" name="p_name">
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品品牌：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<span class="select-box" style="width: 15%;">
					<select name="brand" class="select ">
						{volist name="brand" id="vo"}
							<option value="{$vo.brand_name}">{$vo.brand_name}</option>
						{/volist}
					</select>
				</span>
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品单位：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<span class="select-box" style="width: 15%;">
					<select name="unit" class="select ">
						<option value="套">套</option>
						<option value="件">件</option>
						<option value="台">台</option>
						<option value="瓶">瓶</option>
						<option value="箱">箱</option>
						<option value="盒">盒</option>
						<option value="个">个</option>
						<option value="包">包</option>
						<option value="罐">罐</option>
						<option value="支">支</option>
						<option value="块">块</option>
					</select>
				</span>
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>

		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品产地：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1" value="" placeholder="" id="producing_area" name="producing_area">
				<label style="margin-left: 1%;" class="intro">* </label>
			</div>
		</div>

		<div class="guige_div">
			<label class="form-label col-xs-4 col-sm-2">商品规格：</label>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品价格：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<label style="margin-left: 1%;">零售价: </label>
				<input type="text" class="input-text1 input-text1-15" style="margin-bottom: 1%;" value="" placeholder="" id="original_price" name="original_price"><label style="margin-left: 1%;">元</label>
				<label style="margin-left: 1%;" class="intro">* 此价格为标价</label><br>
				<label style="margin-left: 1%;">会员价: </label>
				<span class="select-box" style="width: 15%;">
					<select name="associator_discount" class="select associator_discount">
						<option value="1">不打折</option>
						<option value="0.90">九折</option>
						<option value="0.80">八折</option>
						<option value="0.70">七折</option>
						<option value="0.60">六折</option>
						<option value="0.50">五折</option>
						<option value="0.40">四折</option>
						<option value="0.30">三折</option>
						<option value="0.20">二折</option>
						<option value="0.15">一五折</option>
						<option value="0.10">一折</option>
					</select>
				</span>
				<input type="text" class="input-text1 input-text1-15" style="margin: 0.5% 0;" value="" placeholder="" id="associator_price" name="associator_price"><label style="margin-left: 1%;">元</label>
				<label style="margin-left: 1%;" class="intro">* 此价格为会员价</label><br>
				<label style="margin-left: 1%;">兑换积分: </label>
				<input type="text" class="input-text1 input-text1-15" style="margin-bottom: 1%;" value="0.00" placeholder="" id="ex_jifen" name="ex_jifen">
				<label style="margin-left: 1%;" class="intro">* 所需积分</label><br>

			</div>
		</div>

		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品排序：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1 input-text1-8" value="0" placeholder="" id="listorder" name="listorder">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">产品重量：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1 input-text1-8" value="" placeholder="" id="weight" name="weight">千克
				<label style="margin-left: 1%;" class="intro">* (请务必仔细填写具体重量)</label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品货号：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1" value="" placeholder="" id="huohao" name="huohao">
				<label style="margin-left: 1%;" class="intro">*</label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">消费税税率：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1 input-text1-8" value="0" placeholder="" id="" name="rate">%
				<label style="margin-left: 1%;" class="intro">(若不填,默认为0%)</label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">关键字: </label>
			<div class="formControls col-xs-8 col-sm-9">
				<input type="text" class="input-text1" value="" placeholder="" id="" name="keywords">
				<label style="margin-left: 1%;" class="intro">(多个关键字务必用半角逗号分开,如: 音乐,数码,图书)</label>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品图片: </label>
			<div class="formControls col-xs-8 col-sm-9">
				<label style="margin-left: 1%;">缩略图:</label>
				<input type="file" class="input-text1" value="" placeholder="" id="thumb" name="thumb">
				<label style="margin-left: 1%;" class="intro">(产品缩略图,请尽量压缩图片大小.)</label><br>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">配置图片上传: </label>
			<div class="formControls col-xs-8 col-sm-9">
				<label style="margin-left: 1%;">图片一:</label>
				<input type="file" class="input-text1" value="" placeholder="" id="image" name="image">
				<label style="margin-left: 1%;" class="intro">(商品配置图片最多五张,作为商品轮播图显示,至少上传一张.)</label><br>
				<label style="margin-left: 1%;">图片二: </label>
				<input type="file" class="input-text1" value="" placeholder="" id="config_image1" name="config_image[]"><br>
				<label style="margin-left: 1%;">图片三: </label>
				<input type="file" class="input-text1" value="" placeholder="" id="config_image2" name="config_image[]"><br>
				<label style="margin-left: 1%;">图片四: </label>
				<input type="file" class="input-text1" value="" placeholder="" id="config_image3" name="config_image[]"><br>
				<label style="margin-left: 1%;">图片五: </label>
				<input type="file" class="input-text1" value="" placeholder="" id="config_image4" name="config_image[]">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品简介文字(小程序专用)：</label>
			<div class="formControls col-xs-8 col-sm-9">
				<textarea name="wx_description" style="width: 320px;height: 100px;"></textarea>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-4 col-sm-2">商品介绍图片(小程序专用): </label>
			<div class="formControls col-xs-8 col-sm-9">
				<label style="margin-left: 1%;">图片一: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image1" name="wx_config_image[]">
				<label style="margin-left: 1%;" class="intro">(商品介绍图片最多十张,作为商品介绍显示,至少上传一张.)</label><br>
				<label style="margin-left: 1%;">图片二: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image2" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片三: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image3" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片四: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image4" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片五: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image5" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片六: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image6" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片七: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image7" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片八: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image8" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片九: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image9" name="wx_config_image[]"><br>
				<label style="margin-left: 1%;">图片十: </label>
				<input type="file" class="input-text1" value="" id="wx_config_image10" name="wx_config_image[]">
			</div>
		</div>

		<div class="row cl">
			<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
				<button class="btn btn-primary radius" type="submit" style="margin-left: 25%;">添&nbsp;加&nbsp;商&nbsp;品</button>
			</div>
		</div>
	</form>
</div>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="__STATIC__/admin/h_ui/lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="__STATIC__/admin/h_ui/lib/layer/2.1/layer.js"></script>
<script type="text/javascript" src="__STATIC__/bis/js/product1.js"></script>

<script>
	var SCOPE = {
		'first_category_url' : "{:url('api/category/getNormalFirstCategory')}",
		'category_url' : "{:url('api/category/getCategoryByParentId')}",
		'df_category_url' : "{:url('bis/Category/getNormalFirstCategory')}",
		'd_category_url' : "{:url('bis/Category/getCategoryByParentId')}",
	};

	$(function(){
		url = SCOPE.first_category_url;
		postData = {};
		$.post(url,postData,function(result){
			if(result.status == 1){
				//将信息填充到html
				data = result.data;
				cat1_id = data[0]['id'];
				getCat2Info(cat1_id);
			}else{
				$('.cat1').html('');
			}
		},'json');

		defined_url = SCOPE.df_category_url;
		$.post(defined_url,postData,function(result){
			if(result.status == 1){
				//将信息填充到html
				data = result.data;
				cat1_id = data[0]['id'];
				getDefinedCat2Info(cat1_id);
			}else{
				$('.d_cat1').html('');
			}
		},'json');


		var str = '<div class="row cl" >'+
				'<label class="form-label col-xs-4 col-sm-2">商品规格：</label>'+
				'<div class="formControls col-xs-8 col-sm-9 ">'+
				'<label style="margin-left: 1%;" class="">规格:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 content1_name" value="" placeholder="如颜色等" id="content1_name[]" name="content1_name[]"> ->'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 con_content1" value="" placeholder="" id="con_content1[]" name="con_content1[]">'+
				'<label style="margin-left: 1%;" class="">积分:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 ex_jifen" value="0.00" placeholder="" id="ex_jifen[]" name="ex_jifen[]">'+
				'<label style="margin-left: 1%;" class="">换购价:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 ex_amount" value="0.00" placeholder="" id="unit_price[]" name="unit_price[]">元'+
				'<label style="margin-left: 1%;" class="">库存量:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 inventory" value="" placeholder="" id="inventory[]" name="inventory[]">'+
				'<button class="btn btn-secondary-outline radius add" type="button" style="margin-left: 0.5%;">+</button>'+
				'</div>'+
				'</div>';
		$('.guige_div').html(str);
	});

	$('.guige_div').on('click','.remove',function(){
		$(this).parent().parent().remove();
	});

	$('.guige_div').on('click','.add',function(){
		var str = '<div class="row cl" >'+
				'<label class="form-label col-xs-4 col-sm-2"></label>'+
				'<div class="formControls col-xs-8 col-sm-9 ">'+
				'<label style="margin-left: 1%;" class="">规格:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 content1_name" value="" placeholder="如颜色等" id="content1_name[]" name="content1_name[]"> ->'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 con_content1" value="" placeholder="" id="con_content1[]" name="con_content1[]">'+
				'<label style="margin-left: 1%;" class="">积分:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 ex_jifen" value="0.00" placeholder="" id="ex_jifen[]" name="ex_jifen[]">'+
				'<label style="margin-left: 1%;" class="">换购价:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 ex_amount" value="0.00" placeholder="" id="unit_price[]" name="unit_price[]">元'+
				'<label style="margin-left: 1%;" class="">库存量:</label>'+
				'<input type="text" style="margin-left: 0.5%;" class="input-text1 input-text1-8 inventory" value="" placeholder="" id="inventory[]" name="inventory[]">'+
				'<button class="btn btn-secondary-outline radius add" type="button" style="margin-left: 0.5%;">+</button>'+
				'</div>'+
				'</div>';
		$('.guige_div').append(str);
	});
</script>
</body>
</html>